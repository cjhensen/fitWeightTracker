angular.module("ag-app",["firebase","ui.router","templatesCache","angular-md5"]).config(["$stateProvider","$urlRouterProvider",function(r,t){r.state("login",{url:"/",controller:"AuthCtrl as authCtrl",templateUrl:"login.html",resolve:{requireNoAuth:["$state","Auth",function(r,t){return t.$requireAuth().then(function(t){r.go("dashboard")},function(r){})}]}}).state("register",{url:"/register",controller:"AuthCtrl as authCtrl",templateUrl:"register.html",resolve:{requireNoAuth:["$state","Auth",function(r,t){return t.$requireAuth().then(function(t){r.go("login")},function(r){})}]}}).state("dashboard",{url:"/dashboard",controller:"DashboardCtrl as dashboardCtrl",templateUrl:"dashboard.html",resolve:{auth:["$state","Users","Auth",function(r,t,e){return e.$requireAuth()["catch"](function(){r.go("login")})}],dashboard:["Logs","Auth",function(r,t){return t.$requireAuth().then(function(t){return r.getLogs(t.uid).$loaded()})}]}}).state("profile",{url:"/profile",controller:"ProfileCtrl as profileCtrl",templateUrl:"profile.html",resolve:{auth:["$state","Users","Auth",function(r,t,e){return e.$requireAuth()["catch"](function(){r.go("login")})}],profile:["Users","Auth",function(r,t){return t.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded()})}]}}),t.otherwise("/")}]).constant("FirebaseUrl","https://ag-app.firebaseio.com/"),angular.module("ag-app").controller("AuthCtrl",["Auth","$state",function(r,t){var e=this;e.user={email:"",password:""},e.login=function(){r.$authWithPassword(e.user).then(function(r){t.go("dashboard")},function(r){e.error=r})},e.register=function(){r.$createUser(e.user).then(function(r){e.login()},function(r){e.error=r})},e.logout=function(){r.$unauth(),t.go("login")}}]),angular.module("ag-app").controller("DashboardCtrl",["$state","auth","Logs","dashboard",function(r,t,e,a){var o=this;o.dashboard=a,o.testDCtrl=function(){console.log("From Logs Service: ",e.getWeight(t.uid).val().weight)},o.addLog=function(){o.dashboard.$save()}}]),angular.module("ag-app").controller("ProfileCtrl",["$state","md5","auth","profile",function(r,t,e,a){var o=this;o.profile=a,o.updateProfile=function(){o.profile.emailHash=t.createHash(e.password.email),o.profile.$save()}}]),angular.module("ag-app").directive("logout",function(){return{restrict:"E",replace:"true",templateUrl:"logout.html",controller:"AuthCtrl as authCtrl"}}),angular.module("ag-app").factory("Auth",["$firebaseAuth","FirebaseUrl",function(r,t){var e=new Firebase(t),a=r(e);return a}]),angular.module("ag-app").factory("Logs",["$firebaseArray","$firebaseObject","FirebaseUrl",function(r,t,e){var a=new Firebase(e+"logs"),o=r(a),n={getLogs:function(r){return t(a.child(r))},getWeight:function(r){var t;return a.child(r).once("value",function(r){t=r}),t},all:o};return n}]),angular.module("ag-app").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl",function(r,t,e){var a=new Firebase(e+"users"),o=r(a),n={getProfile:function(r){return t(a.child(r))},getDisplayName:function(r){return o.$getRecord(r).displayName},getGravatar:function(r){return"//www.gravatar.com/avatar/"+o.$getRecord(r).emailHash},all:o};return n}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2F1dGguY3RybC5qcyIsImNvbnRyb2xsZXJzL2Rhc2hib2FyZC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZS5jdHJsLmpzIiwiZGlyZWN0aXZlcy9sb2dvdXQuZGlyLmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvbG9ncy5zZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlcnMuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsIiRyZXF1aXJlQXV0aCIsInRoZW4iLCJhdXRoIiwiZ28iLCJlcnJvciIsIlVzZXJzIiwiZGFzaGJvYXJkIiwiTG9ncyIsImdldExvZ3MiLCJ1aWQiLCIkbG9hZGVkIiwicHJvZmlsZSIsImdldFByb2ZpbGUiLCJvdGhlcndpc2UiLCJjb25zdGFudCIsImF1dGhDdHJsIiwidGhpcyIsInVzZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwibG9naW4iLCIkYXV0aFdpdGhQYXNzd29yZCIsInJlZ2lzdGVyIiwiJGNyZWF0ZVVzZXIiLCJsb2dvdXQiLCIkdW5hdXRoIiwiZGFzaGJvYXJkQ3RybCIsInRlc3REQ3RybCIsImNvbnNvbGUiLCJsb2ciLCJnZXRXZWlnaHQiLCJ2YWwiLCJ3ZWlnaHQiLCJhZGRMb2ciLCIkc2F2ZSIsIm1kNSIsInByb2ZpbGVDdHJsIiwidXBkYXRlUHJvZmlsZSIsImVtYWlsSGFzaCIsImNyZWF0ZUhhc2giLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJmYWN0b3J5IiwiJGZpcmViYXNlQXV0aCIsIkZpcmViYXNlVXJsIiwicmVmIiwiRmlyZWJhc2UiLCIkZmlyZWJhc2VBcnJheSIsIiRmaXJlYmFzZU9iamVjdCIsImxvZ3NSZWYiLCJsb2dzIiwiY2hpbGQiLCJkYXRhIiwib25jZSIsImRhdGFTbmFwc2hvdCIsImFsbCIsInVzZXJzUmVmIiwidXNlcnMiLCJnZXREaXNwbGF5TmFtZSIsIiRnZXRSZWNvcmQiLCJkaXNwbGF5TmFtZSIsImdldEdyYXZhdGFyIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxVQUNBLFdBQ0EsWUFDQSxpQkFDQSxnQkFFQUMsUUFBQSxpQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxNQUFBLFNBQ0FDLElBQUEsSUFDQUMsV0FBQSx1QkFDQUMsWUFBQSxhQUNBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxjQUNBLFNBQUFDLFdBTUFaLE1BQUEsWUFDQUMsSUFBQSxZQUNBQyxXQUFBLHVCQUNBQyxZQUFBLGdCQUNBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxVQUNBLFNBQUFDLFdBTUFaLE1BQUEsYUFDQUMsSUFBQSxhQUNBQyxXQUFBLGlDQUNBQyxZQUFBLGlCQUNBQyxTQUNBTSxNQUFBLFNBQUEsUUFBQSxPQUFBLFNBQUFKLEVBQUFPLEVBQUFOLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUQsU0FBQSxXQUNBRCxFQUFBSyxHQUFBLGFBR0FHLFdBQUEsT0FBQSxPQUFBLFNBQUFDLEVBQUFSLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUMsS0FBQSxTQUFBQyxHQUNBLE1BQUFLLEdBQUFDLFFBQUFOLEVBQUFPLEtBQUFDLGlCQUtBbEIsTUFBQSxXQUNBQyxJQUFBLFdBQ0FDLFdBQUEsNkJBQ0FDLFlBQUEsZUFDQUMsU0FDQU0sTUFBQSxTQUFBLFFBQUEsT0FBQSxTQUFBSixFQUFBTyxFQUFBTixHQUNBLE1BQUFBLEdBQUFD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bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb25maWd1cmUgdGhlIHJvdXRlcyBmb3IgdGhlIGFwcFxuYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcsIFtcblx0J2ZpcmViYXNlJywgXG5cdCd1aS5yb3V0ZXInLCBcblx0J3RlbXBsYXRlc0NhY2hlJywgXG5cdCdhbmd1bGFyLW1kNSdcblx0XSlcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXHQkc3RhdGVQcm92aWRlclxuXHRcdC5zdGF0ZSgnbG9naW4nLCB7XG5cdFx0XHR1cmw6ICcvJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnLFxuXHRcdFx0cmVzb2x2ZToge1xuXHRcdFx0ICByZXF1aXJlTm9BdXRoOiBmdW5jdGlvbigkc3RhdGUsIEF1dGgpe1xuXHRcdFx0ICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0XHQgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuXHRcdFx0ICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdCAgICAgIHJldHVybjtcblx0XHRcdCAgICB9KTtcblx0XHRcdCAgfVxuXHRcdFx0fVxuXHRcdH0pXG5cdFx0LnN0YXRlKCdyZWdpc3RlcicsIHtcblx0XHRcdHVybDogJy9yZWdpc3RlcicsXG5cdFx0XHRjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHRcdCAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24oJHN0YXRlLCBBdXRoKXtcblx0XHRcdCAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdFx0ICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuXHRcdFx0ICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdCAgICAgIHJldHVybjtcblx0XHRcdCAgICB9KTtcblx0XHRcdCAgfVxuXHRcdFx0fVxuXHRcdH0pXG5cdFx0LnN0YXRlKCdkYXNoYm9hcmQnLCB7XG5cdFx0XHR1cmw6ICcvZGFzaGJvYXJkJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdkYXNoYm9hcmQuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0ICAgIGF1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uKCl7XG5cdFx0ICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG5cdFx0ICAgICAgfSk7XG5cdFx0ICAgIH0sXG5cdFx0ICAgIGRhc2hib2FyZDogZnVuY3Rpb24oTG9ncywgQXV0aCl7XG5cdFx0ICAgICAgcmV0dXJuIEF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbihhdXRoKXtcblx0XHQgICAgICAgIHJldHVybiBMb2dzLmdldExvZ3MoYXV0aC51aWQpLiRsb2FkZWQoKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfVxuXHRcdCAgfVxuXHRcdH0pXG5cdFx0LnN0YXRlKCdwcm9maWxlJywge1xuXHRcdFx0dXJsOiAnL3Byb2ZpbGUnLFxuXHRcdFx0Y29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAncHJvZmlsZS5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHQgICAgYXV0aDogZnVuY3Rpb24oJHN0YXRlLCBVc2VycywgQXV0aCl7XG5cdFx0ICAgICAgcmV0dXJuIEF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24oKXtcblx0XHQgICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfSxcblx0XHQgICAgcHJvZmlsZTogZnVuY3Rpb24oVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0ICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpO1xuXHRcdCAgICAgIH0pO1xuXHRcdCAgICB9XG5cdFx0ICB9XG5cdFx0fSk7XG5cdFx0JHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSlcbi5jb25zdGFudCgnRmlyZWJhc2VVcmwnLCAnaHR0cHM6Ly9hZy1hcHAuZmlyZWJhc2Vpby5jb20vJyk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uY29udHJvbGxlcignQXV0aEN0cmwnLCBmdW5jdGlvbihBdXRoLCAkc3RhdGUpIHtcblx0dmFyIGF1dGhDdHJsID0gdGhpcztcblxuXHRhdXRoQ3RybC51c2VyID0ge1xuXHRcdGVtYWlsOiAnJyxcblx0XHRwYXNzd29yZDogJydcblx0fTtcblxuXHQvLyBsb2dpblxuXHRhdXRoQ3RybC5sb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNhbGxzIHRoZSBhdXRoIHNlcnZpY2UgYW5kIHVzZXMgdGhlIGZpcmViYXNlIGZ1bmN0aW9uIFxuXHRcdC8vIGF1dGhXaXRoUGFzc3dvcmQgYnkgcGFzc2luZyBpbiB0aGUgdXNlclxuXHRcdC8vIHRoZW4gaXQgcmVkaXJlY3RzIHRvIHRoZSBob21lIHN0YXRlIGlmIGF1dGhlbnRpY2F0aW9uIHdhcyBzdWNjZXNzZnVsXG5cdFx0QXV0aC4kYXV0aFdpdGhQYXNzd29yZChhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uKGF1dGgpIHtcblx0XHRcdCRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG5cdFx0fSwgZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdGF1dGhDdHJsLmVycm9yID0gZXJyb3I7XG5cdFx0fSk7XG5cdH07XG5cblx0Ly8gcmVnaXN0ZXJcblx0YXV0aEN0cmwucmVnaXN0ZXIgPSBmdW5jdGlvbigpIHtcblx0XHQvLyBjYWxscyB0aGUgYXV0aCBzZXJ2aWNlIGFuZCB1c2VzIHRoZSBmaXJlYmFzZSBmdW5jdGlvblxuXHRcdC8vIGNyZWF0ZVVzZXIgYnkgcGFzc2luZyBpbiB0ZWggdXNlclxuXHRcdC8vIHRoZW4gaXQgbG9naW4gaW4gdGhlIHVzZXIgYnkgY2FsbGluZyB0aGUgbG9naW4gZnVuY3Rpb24gaW4gXG5cdFx0Ly8gdGhpcyBjb250cm9sbGVyXG5cdFx0QXV0aC4kY3JlYXRlVXNlcihhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcblx0XHRcdGF1dGhDdHJsLmxvZ2luKCk7XG5cdFx0fSwgZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdGF1dGhDdHJsLmVycm9yID0gZXJyb3I7XG5cdFx0fSk7XG5cdH07XG5cblx0YXV0aEN0cmwubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0QXV0aC4kdW5hdXRoKCk7XG5cdFx0JHN0YXRlLmdvKCdsb2dpbicpO1xuXHR9XG5cblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgYXV0aCwgTG9ncywgZGFzaGJvYXJkKSB7XG5cdHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuXHRkYXNoYm9hcmRDdHJsLmRhc2hib2FyZCA9IGRhc2hib2FyZDtcblxuXG5cdGRhc2hib2FyZEN0cmwudGVzdERDdHJsID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29uc29sZS5sb2coJ0Zyb20gTG9ncyBTZXJ2aWNlOiAnLCBMb2dzLmdldFdlaWdodChhdXRoLnVpZCkudmFsKCkud2VpZ2h0KTtcblx0fVxuXHRkYXNoYm9hcmRDdHJsLmFkZExvZyA9IGZ1bmN0aW9uKCkge1xuXHRcdGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLiRzYXZlKCk7XG5cdH07XG5cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHN0YXRlLCBtZDUsIGF1dGgsIHByb2ZpbGUpe1xuICAgIHZhciBwcm9maWxlQ3RybCA9IHRoaXM7XG5cblx0cHJvZmlsZUN0cmwucHJvZmlsZSA9IHByb2ZpbGU7XG5cblx0cHJvZmlsZUN0cmwudXBkYXRlUHJvZmlsZSA9IGZ1bmN0aW9uKCl7XG5cdCAgcHJvZmlsZUN0cmwucHJvZmlsZS5lbWFpbEhhc2ggPSBtZDUuY3JlYXRlSGFzaChhdXRoLnBhc3N3b3JkLmVtYWlsKTtcblx0ICBwcm9maWxlQ3RybC5wcm9maWxlLiRzYXZlKCk7XG5cdH07XG5cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmRpcmVjdGl2ZSgnbG9nb3V0JywgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6ICdFJyxcblx0XHRyZXBsYWNlOiAndHJ1ZScsXG5cdFx0dGVtcGxhdGVVcmw6ICdsb2dvdXQuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJ1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnQXV0aCcsIGZ1bmN0aW9uKCRmaXJlYmFzZUF1dGgsIEZpcmViYXNlVXJsKSB7XG5cdHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuXHR2YXIgYXV0aCA9ICRmaXJlYmFzZUF1dGgocmVmKTtcblxuXHRyZXR1cm4gYXV0aDtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmZhY3RvcnkoJ0xvZ3MnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCkge1xuXHR2YXIgbG9nc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbG9ncycpO1xuXHR2YXIgbG9ncyA9ICRmaXJlYmFzZUFycmF5KGxvZ3NSZWYpO1xuXG5cblx0dmFyIExvZ3MgPSB7XG5cdFx0Z2V0TG9nczogZnVuY3Rpb24odWlkKSB7XG5cdFx0XHRyZXR1cm4gJGZpcmViYXNlT2JqZWN0KGxvZ3NSZWYuY2hpbGQodWlkKSk7XG5cdFx0fSxcblx0XHRnZXRXZWlnaHQ6IGZ1bmN0aW9uKHVpZCkge1xuXHRcdFx0dmFyIGRhdGE7XG5cdFx0XHRsb2dzUmVmLmNoaWxkKHVpZCkub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKGRhdGFTbmFwc2hvdCkge1xuXHRcdFx0XHRkYXRhID0gZGF0YVNuYXBzaG90O1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9LFxuXHRcdGFsbDogbG9nc1xuXHR9O1xuXG5cdHJldHVybiBMb2dzO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnVXNlcnMnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCl7XG4gIHZhciB1c2Vyc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMnKTtcbiAgdmFyIHVzZXJzID0gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYpO1xuXG5cdHZhciBVc2VycyA9IHtcblx0XHRnZXRQcm9maWxlOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcblx0ICB9LFxuXHRcdGdldERpc3BsYXlOYW1lOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5kaXNwbGF5TmFtZTtcblx0ICB9LFxuXHRcdGdldEdyYXZhdGFyOiBmdW5jdGlvbih1aWQpe1xuICBcdFx0cmV0dXJuICcvL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZW1haWxIYXNoO1xuXHRcdH0sXG5cdFx0YWxsOiB1c2Vyc1xuXHR9O1xuXG5cdHJldHVybiBVc2Vycztcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
