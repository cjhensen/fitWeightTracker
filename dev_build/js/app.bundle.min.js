angular.module("ag-app",["firebase","ui.router","templatesCache","angular-md5"]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("login",{url:"/",controller:"AuthCtrl as authCtrl",templateUrl:"login.html",resolve:{requireNoAuth:["$state","Auth",function(t,e){return e.$requireAuth().then(function(e){t.go("dashboard")},function(t){})}]}}).state("register",{url:"/register",controller:"AuthCtrl as authCtrl",templateUrl:"register.html",resolve:{requireNoAuth:["$state","Auth",function(t,e){return e.$requireAuth().then(function(e){t.go("login")},function(t){})}]}}).state("dashboard",{url:"/dashboard",controller:"DashboardCtrl as dashboardCtrl",templateUrl:"dashboard.html",resolve:{auth:["$state","Users","Auth",function(t,e,r){return r.$requireAuth()["catch"](function(){t.go("login")})}],dashboard:["Logs","Auth",function(t,e){return e.$requireAuth().then(function(e){return t.getLogs(e.uid).$loaded()})}]}}).state("profile",{url:"/profile",controller:"ProfileCtrl as profileCtrl",templateUrl:"profile.html",resolve:{auth:["$state","Users","Auth",function(t,e,r){return r.$requireAuth()["catch"](function(){t.go("login")})}],profile:["Users","Auth",function(t,e){return e.$requireAuth().then(function(e){return t.getProfile(e.uid).$loaded()})}]}}),e.otherwise("/")}]).constant("FirebaseUrl","https://ag-app.firebaseio.com/"),angular.module("ag-app").controller("AuthCtrl",["Auth","$state",function(t,e){var r=this;r.user={email:"",password:""},r.login=function(){t.$authWithPassword(r.user).then(function(t){e.go("dashboard")},function(t){r.error=t})},r.register=function(){t.$createUser(r.user).then(function(t){r.login()},function(t){r.error=t})},r.logout=function(){t.$unauth(),e.go("login")}}]),angular.module("ag-app").controller("DashboardCtrl",["$state","auth","Logs","dashboard","CurDate",function(t,e,r,a,o){var n=this;n.dashboard=a,n.testDCtrl=function(){console.log("From Logs Service: ",r.getWeight(e.uid).val().weight)},n.addLog=function(){n.dashboard.$save().then(function(){n.dashboard.weight="",console.log("date",n.dashboard.date)})}}]),angular.module("ag-app").controller("ProfileCtrl",["$state","md5","auth","profile",function(t,e,r,a){var o=this;o.profile=a,o.updateProfile=function(){o.profile.emailHash=e.createHash(r.password.email),o.profile.$save()}}]),angular.module("ag-app").directive("logout",function(){return{restrict:"E",replace:"true",templateUrl:"logout.html",controller:"AuthCtrl as authCtrl"}}),angular.module("ag-app").factory("Auth",["$firebaseAuth","FirebaseUrl",function(t,e){var r=new Firebase(e),a=t(r);return a}]),angular.module("ag-app").factory("CurDate",["$filter",function(t){var e={getCurDate:function(){var t=new Date,e=("0"+t.getDate()).slice(-2),r=("0"+(t.getMonth()+1)).slice(-2),a=t.getFullYear()+"-"+r+"-"+e;return a}};return e}]),angular.module("ag-app").factory("Logs",["$firebaseArray","$firebaseObject","FirebaseUrl","CurDate",function(t,e,r,a){var o=new Firebase(r+"logs"),n=t(o),u={getLogs:function(t){return e(o.child(t).child(a.getCurDate()))},getWeight:function(t){var e;return o.child(t).once("value",function(t){e=t}),e},setWeight:function(t,e,r){o.child(t).child(e).set({date:e,weight:r},function(t){null!==t&&alert("Unable to push log to Firebase!")})},all:n};return u}]),angular.module("ag-app").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl",function(t,e,r){var a=new Firebase(r+"users"),o=t(a),n={getProfile:function(t){return e(a.child(t))},getDisplayName:function(t){return o.$getRecord(t).displayName},getGravatar:function(t){return"//www.gravatar.com/avatar/"+o.$getRecord(t).emailHash},all:o};return n}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2F1dGguY3RybC5qcyIsImNvbnRyb2xsZXJzL2Rhc2hib2FyZC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZS5jdHJsLmpzIiwiZGlyZWN0aXZlcy9sb2dvdXQuZGlyLmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvY3VyRGF0ZS5zZXJ2aWNlLmpzIiwic2VydmljZXMvbG9ncy5zZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlcnMuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsIiRyZXF1aXJlQXV0aCIsInRoZW4iLCJhdXRoIiwiZ28iLCJlcnJvciIsIlVzZXJzIiwiZGFzaGJvYXJkIiwiTG9ncyIsImdldExvZ3MiLCJ1aWQiLCIkbG9hZGVkIiwicHJvZmlsZSIsImdldFByb2ZpbGUiLCJvdGhlcndpc2UiLCJjb25zdGFudCIsImF1dGhDdHJsIiwidGhpcyIsInVzZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwibG9naW4iLCIkYXV0aFdpdGhQYXNzd29yZCIsInJlZ2lzdGVyIiwiJGNyZWF0ZVVzZXIiLCJsb2dvdXQiLCIkdW5hdXRoIiwiQ3VyRGF0ZSIsImRhc2hib2FyZEN0cmwiLCJ0ZXN0REN0cmwiLCJjb25zb2xlIiwibG9nIiwiZ2V0V2VpZ2h0IiwidmFsIiwid2VpZ2h0IiwiYWRkTG9nIiwiJHNhdmUiLCJkYXRlIiwibWQ1IiwicHJvZmlsZUN0cmwiLCJ1cGRhdGVQcm9maWxlIiwiZW1haWxIYXNoIiwiY3JlYXRlSGFzaCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicmVwbGFjZSIsImZhY3RvcnkiLCIkZmlyZWJhc2VBdXRoIiwiRmlyZWJhc2VVcmwiLCJyZWYiLCJGaXJlYmFzZSIsIiRmaWx0ZXIiLCJnZXRDdXJEYXRlIiwibm93IiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJzbGljZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ0b2RheSIsImdldEZ1bGxZZWFyIiwiJGZpcmViYXNlQXJyYXkiLCIkZmlyZWJhc2VPYmplY3QiLCJsb2dzUmVmIiwibG9ncyIsImNoaWxkIiwiZGF0YSIsIm9uY2UiLCJkYXRhU25hcHNob3QiLCJzZXRXZWlnaHQiLCJzZXQiLCJhbGVydCIsImFsbCIsInVzZXJzUmVmIiwidXNlcnMiLCJnZXREaXNwbGF5TmFtZSIsIiRnZXRSZWNvcmQiLCJkaXNwbGF5TmFtZSIsImdldEdyYXZhdGFyIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxVQUNBLFdBQ0EsWUFDQSxpQkFDQSxnQkFFQUMsUUFBQSxpQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxNQUFBLFNBQ0FDLElBQUEsSUFDQUMsV0FBQSx1QkFDQUMsWUFBQSxhQUNBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxjQUNBLFNBQUFDLFdBTUFaLE1BQUEsWUFDQUMsSUFBQSxZQUNBQyxXQUFBLHVCQUNBQyxZQUFBLGdCQUNBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxVQUNBLFNBQUFDLFdBTUFaLE1BQUEsYUFDQUMsSUFBQSxhQUNBQyxXQUFBLGlDQUNBQyxZQUFBLGlCQUNBQyxTQUNBTSxNQUFBLFNBQUEsUUFBQSxPQUFBLFNBQUFKLEVBQUFPLEVBQUFOLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUQsU0FBQSxXQUNBRCxFQUFBSyxHQUFBLGFBR0FHLFdBQUEsT0FBQSxPQUFBLFNBQUFDLEVBQUFSLEdBQ0EsTUFB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QUUsR0FHQXhELEdBQ0FDLFFBQUEsU0FBQUMsR0FLQSxNQUFBcUQsR0FBQUMsRUFBQUUsTUFBQXhELEdBQUF3RCxNQUFBdkMsRUFBQXlCLGdCQUVBcEIsVUFBQSxTQUFBdEIsR0FDQSxHQUFBeUQsRUFJQSxPQUhBSCxHQUFBRSxNQUFBeEQsR0FBQTBELEtBQUEsUUFBQSxTQUFBQyxHQUNBRixFQUFBRSxJQUVBRixHQUVBRyxVQUFBLFNBQUE1RCxFQUFBMkIsRUFBQUgsR0FDQThCLEVBQUFFLE1BQUF4RCxHQUFBd0QsTUFBQTdCLEdBQUFrQyxLQUNBbEMsS0FBQUEsRUFDQUgsT0FBQUEsR0FDQSxTQUFBN0IsR0FDQSxPQUFBQSxHQUNBbUUsTUFBQSxzQ0FJQUMsSUFBQVIsRUFHQSxPQUFBekQsTUNsQ0FwQixRQUFBQyxPQUFBLFVBQ0F5RCxRQUFBLFNBQUEsaUJBQUEsa0JBQUEsY0FBQSxTQUFBZ0IsRUFBQUMsRUFBQWYsR0FDQSxHQUFBMEIsR0FBQSxHQUFBeEIsVUFBQUYsRUFBQSxTQUNBMkIsRUFBQWIsRUFBQVksR0FFQXBFLEdBQ0FPLFdBQUEsU0FBQUgsR0FDQSxNQUFBcUQsR0FBQVcsRUFBQVIsTUFBQXhELEtBRUFrRSxlQUFBLFNBQUFsRSxHQUNBLE1BQUFpRSxHQUFBRSxXQUFBbkUsR0FBQW9FLGFBRUFDLFlBQUEsU0FBQXJFLEdBQ0EsTUFBQSw2QkFBQWlFLEVBQUFFLFdBQUFuRSxHQUFBK0IsV0FFQWdDLElBQUFFLEVBR0EsT0FBQXJFIiwiZmlsZSI6ImFwcC5idW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uZmlndXJlIHRoZSByb3V0ZXMgZm9yIHRoZSBhcHBcbmFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnLCBbXG5cdCdmaXJlYmFzZScsIFxuXHQndWkucm91dGVyJywgXG5cdCd0ZW1wbGF0ZXNDYWNoZScsIFxuXHQnYW5ndWxhci1tZDUnXG5cdF0pXG4uY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXJcblx0XHQuc3RhdGUoJ2xvZ2luJywge1xuXHRcdFx0dXJsOiAnLycsXG5cdFx0XHRjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHRcdCAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24oJHN0YXRlLCBBdXRoKXtcblx0XHRcdCAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdFx0ICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcblx0XHRcdCAgICB9LCBmdW5jdGlvbihlcnJvcil7XG5cdFx0XHQgICAgICByZXR1cm47XG5cdFx0XHQgICAgfSk7XG5cdFx0XHQgIH1cblx0XHRcdH1cblx0XHR9KVxuXHRcdC5zdGF0ZSgncmVnaXN0ZXInLCB7XG5cdFx0XHR1cmw6ICcvcmVnaXN0ZXInLFxuXHRcdFx0Y29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0XHQgIHJlcXVpcmVOb0F1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgQXV0aCl7XG5cdFx0XHQgICAgcmV0dXJuIEF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbihhdXRoKXtcblx0XHRcdCAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcblx0XHRcdCAgICB9LCBmdW5jdGlvbihlcnJvcil7XG5cdFx0XHQgICAgICByZXR1cm47XG5cdFx0XHQgICAgfSk7XG5cdFx0XHQgIH1cblx0XHRcdH1cblx0XHR9KVxuXHRcdC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuXHRcdFx0dXJsOiAnL2Rhc2hib2FyZCcsXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnZGFzaGJvYXJkLmh0bWwnLFxuXHRcdFx0cmVzb2x2ZToge1xuXHRcdCAgICBhdXRoOiBmdW5jdGlvbigkc3RhdGUsIFVzZXJzLCBBdXRoKXtcblx0XHQgICAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbigpe1xuXHRcdCAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuXHRcdCAgICAgIH0pO1xuXHRcdCAgICB9LFxuXHRcdCAgICBkYXNoYm9hcmQ6IGZ1bmN0aW9uKExvZ3MsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0ICAgICAgICByZXR1cm4gTG9ncy5nZXRMb2dzKGF1dGgudWlkKS4kbG9hZGVkKCk7XG5cdFx0ICAgICAgfSk7XG5cdFx0ICAgIH1cblx0XHQgIH1cblx0XHR9KVxuXHRcdC5zdGF0ZSgncHJvZmlsZScsIHtcblx0XHRcdHVybDogJy9wcm9maWxlJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0ICAgIGF1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uKCl7XG5cdFx0ICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG5cdFx0ICAgICAgfSk7XG5cdFx0ICAgIH0sXG5cdFx0ICAgIHByb2ZpbGU6IGZ1bmN0aW9uKFVzZXJzLCBBdXRoKXtcblx0XHQgICAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdCAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfVxuXHRcdCAgfVxuXHRcdH0pO1xuXHRcdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pXG4uY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vYWctYXBwLmZpcmViYXNlaW8uY29tLycpOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmNvbnRyb2xsZXIoJ0F1dGhDdHJsJywgZnVuY3Rpb24oQXV0aCwgJHN0YXRlKSB7XG5cdHZhciBhdXRoQ3RybCA9IHRoaXM7XG5cblx0YXV0aEN0cmwudXNlciA9IHtcblx0XHRlbWFpbDogJycsXG5cdFx0cGFzc3dvcmQ6ICcnXG5cdH07XG5cblx0Ly8gbG9naW5cblx0YXV0aEN0cmwubG9naW4gPSBmdW5jdGlvbigpIHtcblx0XHQvLyBjYWxscyB0aGUgYXV0aCBzZXJ2aWNlIGFuZCB1c2VzIHRoZSBmaXJlYmFzZSBmdW5jdGlvbiBcblx0XHQvLyBhdXRoV2l0aFBhc3N3b3JkIGJ5IHBhc3NpbmcgaW4gdGhlIHVzZXJcblx0XHQvLyB0aGVuIGl0IHJlZGlyZWN0cyB0byB0aGUgaG9tZSBzdGF0ZSBpZiBhdXRoZW50aWNhdGlvbiB3YXMgc3VjY2Vzc2Z1bFxuXHRcdEF1dGguJGF1dGhXaXRoUGFzc3dvcmQoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbihhdXRoKSB7XG5cdFx0XHQkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuXHRcdH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuXHRcdH0pO1xuXHR9O1xuXG5cdC8vIHJlZ2lzdGVyXG5cdGF1dGhDdHJsLnJlZ2lzdGVyID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY2FsbHMgdGhlIGF1dGggc2VydmljZSBhbmQgdXNlcyB0aGUgZmlyZWJhc2UgZnVuY3Rpb25cblx0XHQvLyBjcmVhdGVVc2VyIGJ5IHBhc3NpbmcgaW4gdGVoIHVzZXJcblx0XHQvLyB0aGVuIGl0IGxvZ2luIGluIHRoZSB1c2VyIGJ5IGNhbGxpbmcgdGhlIGxvZ2luIGZ1bmN0aW9uIGluIFxuXHRcdC8vIHRoaXMgY29udHJvbGxlclxuXHRcdEF1dGguJGNyZWF0ZVVzZXIoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbih1c2VyKSB7XG5cdFx0XHRhdXRoQ3RybC5sb2dpbigpO1xuXHRcdH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuXHRcdH0pO1xuXHR9O1xuXG5cdGF1dGhDdHJsLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuXHRcdEF1dGguJHVuYXV0aCgpO1xuXHRcdCRzdGF0ZS5nbygnbG9naW4nKTtcblx0fVxuXG5cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZEN0cmwnLCBmdW5jdGlvbigkc3RhdGUsIGF1dGgsIExvZ3MsIGRhc2hib2FyZCwgQ3VyRGF0ZSkge1xuXHR2YXIgZGFzaGJvYXJkQ3RybCA9IHRoaXM7XG5cblx0ZGFzaGJvYXJkQ3RybC5kYXNoYm9hcmQgPSBkYXNoYm9hcmQ7XG5cblx0Ly8gaW5pdGlhbGx5IHRoZSB3ZWlnaHQgaXMgbm90IHNldCBhbmQgdGhlIGZvcm0gaXMgY2xlYXJcblx0Ly9kYXNoYm9hcmRDdHJsLmRhc2hib2FyZC53ZWlnaHQgPSBcIlwiO1xuXG5cdGRhc2hib2FyZEN0cmwudGVzdERDdHJsID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29uc29sZS5sb2coJ0Zyb20gTG9ncyBTZXJ2aWNlOiAnLCBMb2dzLmdldFdlaWdodChhdXRoLnVpZCkudmFsKCkud2VpZ2h0KTtcblx0fVxuXHRkYXNoYm9hcmRDdHJsLmFkZExvZyA9IGZ1bmN0aW9uKCkge1xuXHRcdGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLiRzYXZlKCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdC8vIGFmdGVyIHNhdmluZyB0aGUgdmFsdWUgdG8gdGhlIERCLCBjbGVhciB0aGUgZmllbGRcblx0XHRcdGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLndlaWdodCA9IFwiXCI7XG5cdFx0XHRjb25zb2xlLmxvZygnZGF0ZScsIGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLmRhdGUpO1xuXHRcdH0pO1xuXG5cdC8vIExvZ3Muc2V0V2VpZ2h0KGF1dGgudWlkLCBkYXNoYm9hcmRDdHJsLmRhc2hib2FyZC5kYXRlLCBkYXNoYm9hcmRDdHJsLmRhc2hib2FyZC53ZWlnaHQpO1xuXHQvLyBkYXNoYm9hcmRDdHJsLmRhc2hib2FyZC53ZWlnaHQgPSBcIlwiO1xuXHR9O1xuXG5cdC8vIGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLmRhdGUgPSBDdXJEYXRlLmdldEN1ckRhdGUoKTtcblxuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgbWQ1LCBhdXRoLCBwcm9maWxlKXtcbiAgICB2YXIgcHJvZmlsZUN0cmwgPSB0aGlzO1xuXG5cdHByb2ZpbGVDdHJsLnByb2ZpbGUgPSBwcm9maWxlO1xuXG5cdHByb2ZpbGVDdHJsLnVwZGF0ZVByb2ZpbGUgPSBmdW5jdGlvbigpe1xuXHQgIHByb2ZpbGVDdHJsLnByb2ZpbGUuZW1haWxIYXNoID0gbWQ1LmNyZWF0ZUhhc2goYXV0aC5wYXNzd29yZC5lbWFpbCk7XG5cdCAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpO1xuXHR9O1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5kaXJlY3RpdmUoJ2xvZ291dCcsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiAnRScsXG5cdFx0cmVwbGFjZTogJ3RydWUnLFxuXHRcdHRlbXBsYXRlVXJsOiAnbG9nb3V0Lmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCdcblx0fTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmZhY3RvcnkoJ0F1dGgnLCBmdW5jdGlvbigkZmlyZWJhc2VBdXRoLCBGaXJlYmFzZVVybCkge1xuXHR2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcblx0dmFyIGF1dGggPSAkZmlyZWJhc2VBdXRoKHJlZik7XG5cblx0cmV0dXJuIGF1dGg7XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5mYWN0b3J5KCdDdXJEYXRlJywgZnVuY3Rpb24oJGZpbHRlcikge1xuXHR2YXIgQ3VyRGF0ZSA9IHtcblx0XHRnZXRDdXJEYXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdFx0dmFyIGRheSA9IChcIjBcIiArIG5vdy5nZXREYXRlKCkpLnNsaWNlKC0yKTtcblx0XHRcdHZhciBtb250aCA9IChcIjBcIiArIChub3cuZ2V0TW9udGgoKSArIDEpKS5zbGljZSgtMik7XG5cdFx0XHR2YXIgdG9kYXkgPSBub3cuZ2V0RnVsbFllYXIoKStcIi1cIisobW9udGgpK1wiLVwiKyhkYXkpO1xuXHRcdFx0cmV0dXJuIHRvZGF5O1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gQ3VyRGF0ZTtcbn0pO1x0IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnTG9ncycsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCBDdXJEYXRlKSB7XG5cdHZhciBsb2dzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydsb2dzJyk7XG5cdHZhciBsb2dzID0gJGZpcmViYXNlQXJyYXkobG9nc1JlZik7XG5cblxuXHR2YXIgTG9ncyA9IHtcblx0XHRnZXRMb2dzOiBmdW5jdGlvbih1aWQpIHtcblx0XHRcdC8vIHJldHVybmluZyB0aGUgY3VycmVudCBkYXRlIGNoaWxkIGJhY2sgdG8gdGhlIHJvdXRlIHNvIGl0IGlzIGF2YWlsYWJsZSB0byBzYXZlXG5cdFx0XHQvLyBkYXRhIHRvIGZyb20gdGhlIHJvdXRlIGFuZCB0aGUgZGFzaGJvYXJkQ3RybFxuXHRcdFx0Ly8gUFJPQkxFTSBXSVRIIFRISVMgSVMgVEhJUyBEQVRFIElTIFRIRSBPTkxZIE9ORSBZT1UgSEFWRSBBQ0NFU1MgVE8gQU5EIElGIFlPVVxuXHRcdFx0Ly8gQ0hBTkdFIFRIRSBEQVRFIElOIFRIRSBEQVRFUElDS0VSLCBUSEUgTE9HUyBET04nVCBDSEFOR0UgRk9SIFRIQVQgREFURVxuXHRcdFx0cmV0dXJuICRmaXJlYmFzZU9iamVjdChsb2dzUmVmLmNoaWxkKHVpZCkuY2hpbGQoQ3VyRGF0ZS5nZXRDdXJEYXRlKCkpKTtcblx0XHR9LFxuXHRcdGdldFdlaWdodDogZnVuY3Rpb24odWlkKSB7XG5cdFx0XHR2YXIgZGF0YTtcblx0XHRcdGxvZ3NSZWYuY2hpbGQodWlkKS5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oZGF0YVNuYXBzaG90KSB7XG5cdFx0XHRcdGRhdGEgPSBkYXRhU25hcHNob3Q7XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0sXG5cdFx0c2V0V2VpZ2h0OiBmdW5jdGlvbih1aWQsIGRhdGUsIHdlaWdodCkge1xuXHRcdFx0bG9nc1JlZi5jaGlsZCh1aWQpLmNoaWxkKGRhdGUpLnNldCh7XG5cdFx0XHRcdGRhdGU6IGRhdGUsXG5cdFx0XHRcdHdlaWdodDogd2VpZ2h0XG5cdFx0XHR9LCBmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0XHRpZiAoZXJyb3IgIT09IG51bGwpIHtcblx0XHRcdFx0XHRhbGVydCgnVW5hYmxlIHRvIHB1c2ggbG9nIHRvIEZpcmViYXNlIScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGFsbDogbG9nc1xuXHR9O1xuXG5cdHJldHVybiBMb2dzO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnVXNlcnMnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCl7XG4gIHZhciB1c2Vyc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMnKTtcbiAgdmFyIHVzZXJzID0gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYpO1xuXG5cdHZhciBVc2VycyA9IHtcblx0XHRnZXRQcm9maWxlOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcblx0ICB9LFxuXHRcdGdldERpc3BsYXlOYW1lOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5kaXNwbGF5TmFtZTtcblx0ICB9LFxuXHRcdGdldEdyYXZhdGFyOiBmdW5jdGlvbih1aWQpe1xuICBcdFx0cmV0dXJuICcvL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZW1haWxIYXNoO1xuXHRcdH0sXG5cdFx0YWxsOiB1c2Vyc1xuXHR9O1xuXG5cdHJldHVybiBVc2Vycztcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
