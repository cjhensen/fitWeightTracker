angular.module("ag-app",["firebase","ui.router","templatesCache","angular-md5"]).config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("home",{url:"/",templateUrl:"home.html"}).state("login",{url:"/login",controller:"AuthCtrl as authCtrl",templateUrl:"login.html",resolve:{requireNoAuth:["$state","Auth",function(e,r){return r.$requireAuth().then(function(r){e.go("dashboard")},function(e){})}]}}).state("register",{url:"/register",controller:"AuthCtrl as authCtrl",templateUrl:"register.html",resolve:{requireNoAuth:["$state","Auth",function(e,r){return r.$requireAuth().then(function(r){e.go("home")},function(e){})}]}}).state("dashboard",{url:"/dashboard",controller:"DashboardCtrl as dashboardCtrl",templateUrl:"dashboard.html",resolve:{auth:["$state","Users","Auth",function(e,r,t){return t.$requireAuth()["catch"](function(){e.go("home")})}],dashboard:["Logs","Auth",function(e,r){return r.$requireAuth().then(function(r){return e.getLogs(r.uid).$loaded()})}]}}).state("profile",{url:"/profile",controller:"ProfileCtrl as profileCtrl",templateUrl:"profile.html",resolve:{auth:["$state","Users","Auth",function(e,r,t){return t.$requireAuth()["catch"](function(){e.go("home")})}],profile:["Users","Auth",function(e,r){return r.$requireAuth().then(function(r){return e.getProfile(r.uid).$loaded()})}]}}),r.otherwise("/")}]).constant("FirebaseUrl","https://ag-app.firebaseio.com/"),angular.module("ag-app").controller("AuthCtrl",["Auth","$state",function(e,r){var t=this;t.user={email:"",password:""},t.login=function(){e.$authWithPassword(t.user).then(function(e){r.go("home")},function(e){t.error=e})},t.register=function(){e.$createUser(t.user).then(function(e){t.login()},function(e){t.error=e})},t.logOut=function(){e.$unauth(),r.go("home")}}]),angular.module("ag-app").controller("DashboardCtrl",["$state","auth","Logs","dashboard",function(e,r,t,a){var o=this;o.dashboard=a,o.testDCtrl=function(){console.log("From Logs Service: ",t.getWeight(r.uid).val().weight)},o.addLog=function(){o.dashboard.$save()}}]),angular.module("ag-app").controller("ProfileCtrl",["$state","md5","auth","profile",function(e,r,t,a){var o=this;o.profile=a,o.updateProfile=function(){o.profile.emailHash=r.createHash(t.password.email),o.profile.$save()}}]),angular.module("ag-app").factory("Auth",["$firebaseAuth","FirebaseUrl",function(e,r){var t=new Firebase(r),a=e(t);return a}]),angular.module("ag-app").factory("Logs",["$firebaseArray","$firebaseObject","FirebaseUrl",function(e,r,t){var a=new Firebase(t+"logs"),o=e(a),n={getLogs:function(e){return r(a.child(e))},getWeight:function(e){var r;return a.child(e).once("value",function(e){r=e}),r},all:o};return n}]),angular.module("ag-app").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl",function(e,r,t){var a=new Firebase(t+"users"),o=e(a),n={getProfile:function(e){return r(a.child(e))},getDisplayName:function(e){return o.$getRecord(e).displayName},getGravatar:function(e){return"//www.gravatar.com/avatar/"+o.$getRecord(e).emailHash},all:o};return n}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2F1dGguY3RybC5qcyIsImNvbnRyb2xsZXJzL2Rhc2hib2FyZC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZS5jdHJsLmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvbG9ncy5zZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlcnMuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsIiRyZXF1aXJlQXV0aCIsInRoZW4iLCJhdXRoIiwiZ28iLCJlcnJvciIsIlVzZXJzIiwiZGFzaGJvYXJkIiwiTG9ncyIsImdldExvZ3MiLCJ1aWQiLCIkbG9hZGVkIiwicHJvZmlsZSIsImdldFByb2ZpbGUiLCJvdGhlcndpc2UiLCJjb25zdGFudCIsImF1dGhDdHJsIiwidGhpcyIsInVzZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwibG9naW4iLCIkYXV0aFdpdGhQYXNzd29yZCIsInJlZ2lzdGVyIiwiJGNyZWF0ZVVzZXIiLCJsb2dPdXQiLCIkdW5hdXRoIiwiZGFzaGJvYXJkQ3RybCIsInRlc3REQ3RybCIsImNvbnNvbGUiLCJsb2ciLCJnZXRXZWlnaHQiLCJ2YWwiLCJ3ZWlnaHQiLCJhZGRMb2ciLCIkc2F2ZSIsIm1kNSIsInByb2ZpbGVDdHJsIiwidXBkYXRlUHJvZmlsZSIsImVtYWlsSGFzaCIsImNyZWF0ZUhhc2giLCJmYWN0b3J5IiwiJGZpcmViYXNlQXV0aCIsIkZpcmViYXNlVXJsIiwicmVmIiwiRmlyZWJhc2UiLCIkZmlyZWJhc2VBcnJheSIsIiRmaXJlYmFzZU9iamVjdCIsImxvZ3NSZWYiLCJsb2dzIiwiY2hpbGQiLCJkYXRhIiwib25jZSIsImRhdGFTbmFwc2hvdCIsImFsbCIsInVzZXJzUmVmIiwidXNlcnMiLCJnZXREaXNwbGF5TmFtZSIsIiRnZXRSZWNvcmQiLCJkaXNwbGF5TmFtZSIsImdldEdyYXZhdGFyIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxVQUNBLFdBQ0EsWUFDQSxpQkFDQSxnQkFFQUMsUUFBQSxpQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxNQUFBLFFBQ0FDLElBQUEsSUFDQUMsWUFBQSxjQUVBRixNQUFBLFNBQ0FDLElBQUEsU0FDQUUsV0FBQSx1QkFDQUQsWUFBQSxhQUNBRSxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxjQUNBLFNBQUFDLFdBTUFaLE1BQUEsWUFDQUMsSUFBQSxZQUNBRSxXQUFBLHVCQUNBRCxZQUFBLGdCQUNBRSxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxTQUNBLFNBQUFDLFdBTUFaLE1BQUEsYUFDQUMsSUFBQSxhQUNBRSxXQUFBLGlDQUNBRCxZQUFBLGlCQUNBRSxTQUNBTSxNQUFBLFNBQUEsUUFBQSxPQUFBLFNBQUFKLEVBQUFPLEVBQUFOLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUQsU0FBQSxXQUNBRCxFQUFBSyxHQUFBLFlBR0FHLFdBQUEsT0FBQSxPQUFBLFNBQUFDLEVBQUFSLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUMsS0FBQSxTQUFBQyxHQUNBLE1BQUFLLEdBQUFDLFFBQUFOLEVBQUFPLEtBQUFDLGlCQUtBbEIsTUFBQSxXQUNBQyxJQUFBLFdBQ0FFLFdBQUEsNkJBQ0FELFlBQUEsZUFDQUUsU0FDQU0sTUFBQSxTQUFBLFFBQUEsT0FBQSxTQUFBSixFQUFBTyxFQUFBTixHQUNBLE1BQUFBLEdBQUFDLGVBQUFELFNBQUEsV0FDQUQsRUFBQUssR0FBQSxZQUdBUSxTQUFBLFFBQUEsT0FBQSxTQUFBTixFQUFBTixHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQSxNQUFBRyxHQUFBTyxXQUFBVixFQUFBTyxLQUFBQyxpQkFLQW5CLEVBQUFzQixVQUFBLFFBRUFDLFNBQUEsY0FBQSxrQ0M1RUEzQixRQUFBQyxPQUFBLFVBQ0FPLFdBQUEsWUFBQSxPQUFBLFNBQUEsU0FBQUksRUFBQUQsR0FDQSxHQUFBaUIsR0FBQUMsSUFFQUQsR0FBQUUsTUFDQUMsTUFBQSxHQUNBQyxTQUFBLElBSUFKLEVBQUFLLE1BQUEsV0FJQXJCLEVBQUFzQixrQkFBQU4sRUFBQUUsTUFBQWhCLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxTQUNBLFNBQUFDLEdBQ0FXLEVBQUFYLE1BQUFBLEtBS0FXLEVBQUFPLFNBQUEsV0FLQXZCLEVBQUF3QixZQUFBUixFQUFBRSxNQUFBaEIsS0FBQSxTQUFBZ0IsR0FDQUYsRUFBQUssU0FDQSxTQUFBaEIsR0FDQVcsRUFBQVgsTUFBQUEsS0FJQVcsRUFBQVMsT0FBQSxXQUNBekIsRUFBQTBCLFVBQ0EzQixFQUFBSyxHQUFBLFlDcENBaEIsUUFBQUMsT0FBQSxVQUNBTyxXQUFBLGlCQUFBLFNBQUEsT0FBQSxPQUFBLFlBQUEsU0FBQUcsRUFBQUksRUFBQUssRUFBQUQsR0FDQSxHQUFBb0IsR0FBQVYsSUFFQVUsR0FBQXBCLFVBQUFBLEVBR0FvQixFQUFBQyxVQUFBLFdBQ0FDLFFBQUFDLElBQUEsc0JBQUF0QixFQUFBdUIsVUFBQTVCLEVBQUFPLEtBQUFzQixNQUFBQyxTQUVBTixFQUFBTyxPQUFBLFdBQ0FQLEVBQUFwQixVQUFBNEIsWUNYQS9DLFFBQUFDLE9BQUEsVUFDQU8sV0FBQSxlQUFBLFNBQUEsTUFBQSxPQUFBLFVBQUEsU0FBQUcsRUFBQXFDLEVBQUFqQyxFQUFBUyxHQUNBLEdBQUF5QixHQUFBcEIsSUFFQW9CLEdBQUF6QixRQUFBQSxFQUVBeUIsRUFBQUMsY0FBQSxXQUNBRCxFQUFBekIsUUFBQTJCLFVBQUFILEVBQUFJLFdBQUFyQyxFQUFBaUIsU0FBQUQsT0FDQWtCLEVBQUF6QixRQUFBdUIsWUNSQS9DLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsUUFBQSxnQkFBQSxjQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQSxHQUFBQyxVQUFBRixHQUNBeEMsRUFBQXVDLEVBQUFFLEVBRUEsT0FBQXpDLE1DTEFmLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsUUFBQSxpQkFBQSxrQkFBQSxjQUFBLFNBQUFLLEVBQUFDLEVBQUFKLEdBQ0EsR0FBQUssR0FBQSxHQUFBSCxVQUFBRixFQUFBLFFBQ0FNLEVBQUFILEVBQUFFLEdBR0F4QyxHQUNBQyxRQUFBLFNBQUFDLEdBQ0EsTUFBQXFDLEdBQUFDLEVBQUFFLE1BQUF4QyxLQUVBcUIsVUFBQSxTQUFBckIsR0FDQSxHQUFBeUMsRUFJQSxPQUhBSCxHQUFBRSxNQUFBeEMsR0FBQTBDLEtBQUEsUUFBQSxTQUFBQyxHQUNBRixFQUFBRSxJQUVBRixHQUVBRyxJQUFBTCxFQUdBLE9BQUF6QyxNQ3BCQXBCLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsU0FBQSxpQkFBQSxrQkFBQSxjQUFBLFNBQUFLLEVBQUFDLEVBQUFKLEdBQ0EsR0FBQVksR0FBQSxHQUFBVixVQUFBRixFQUFBLFNBQ0FhLEVBQUFWLEVBQUFTLEdBRUFqRCxHQUNBTyxXQUFBLFNBQUFILEdBQ0EsTUFBQXFDLEdBQUFRLEVBQUFMLE1BQUF4QyxLQUVBK0MsZUFBQSxTQUFBL0MsR0FDQSxNQUFBOEMsR0FBQUUsV0FBQWhELEdBQUFpRCxhQUVBQyxZQUFBLFNBQUFsRCxHQUNBLE1BQUEsNkJBQUE4QyxFQUFBRSxXQUFBaEQsR0FBQTZCLFdBRUFlLElBQUFFLEVBR0EsT0FBQWxEIiwiZmlsZSI6ImFwcC5idW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcsIFtcblx0J2ZpcmViYXNlJywgXG5cdCd1aS5yb3V0ZXInLCBcblx0J3RlbXBsYXRlc0NhY2hlJywgXG5cdCdhbmd1bGFyLW1kNSdcblx0XSlcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXHQkc3RhdGVQcm92aWRlclxuXHRcdC5zdGF0ZSgnaG9tZScsIHtcblx0XHRcdHVybDogJy8nLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdob21lLmh0bWwnXG5cdFx0fSlcblx0XHQuc3RhdGUoJ2xvZ2luJywge1xuXHRcdFx0dXJsOiAnL2xvZ2luJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnLFxuXHRcdFx0cmVzb2x2ZToge1xuXHRcdFx0ICByZXF1aXJlTm9BdXRoOiBmdW5jdGlvbigkc3RhdGUsIEF1dGgpe1xuXHRcdFx0ICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0XHQgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuXHRcdFx0ICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdCAgICAgIHJldHVybjtcblx0XHRcdCAgICB9KTtcblx0XHRcdCAgfVxuXHRcdFx0fVxuXHRcdH0pXG5cdFx0LnN0YXRlKCdyZWdpc3RlcicsIHtcblx0XHRcdHVybDogJy9yZWdpc3RlcicsXG5cdFx0XHRjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHRcdCAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24oJHN0YXRlLCBBdXRoKXtcblx0XHRcdCAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdFx0ICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG5cdFx0XHQgICAgfSwgZnVuY3Rpb24oZXJyb3Ipe1xuXHRcdFx0ICAgICAgcmV0dXJuO1xuXHRcdFx0ICAgIH0pO1xuXHRcdFx0ICB9XG5cdFx0XHR9XG5cdFx0fSlcblx0XHQuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcblx0XHRcdHVybDogJy9kYXNoYm9hcmQnLFxuXHRcdFx0Y29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ2Rhc2hib2FyZC5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHQgICAgYXV0aDogZnVuY3Rpb24oJHN0YXRlLCBVc2VycywgQXV0aCl7XG5cdFx0ICAgICAgcmV0dXJuIEF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24oKXtcblx0XHQgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuXHRcdCAgICAgIH0pO1xuXHRcdCAgICB9LFxuXHRcdCAgICBkYXNoYm9hcmQ6IGZ1bmN0aW9uKExvZ3MsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0ICAgICAgICByZXR1cm4gTG9ncy5nZXRMb2dzKGF1dGgudWlkKS4kbG9hZGVkKCk7XG5cdFx0ICAgICAgfSk7XG5cdFx0ICAgIH1cblx0XHQgIH1cblx0XHR9KVxuXHRcdC5zdGF0ZSgncHJvZmlsZScsIHtcblx0XHRcdHVybDogJy9wcm9maWxlJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0ICAgIGF1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uKCl7XG5cdFx0ICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfSxcblx0XHQgICAgcHJvZmlsZTogZnVuY3Rpb24oVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24oYXV0aCl7XG5cdFx0ICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpO1xuXHRcdCAgICAgIH0pO1xuXHRcdCAgICB9XG5cdFx0ICB9XG5cdFx0fSk7XG5cdFx0JHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSlcbi5jb25zdGFudCgnRmlyZWJhc2VVcmwnLCAnaHR0cHM6Ly9hZy1hcHAuZmlyZWJhc2Vpby5jb20vJyk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uY29udHJvbGxlcignQXV0aEN0cmwnLCBmdW5jdGlvbihBdXRoLCAkc3RhdGUpIHtcblx0dmFyIGF1dGhDdHJsID0gdGhpcztcblxuXHRhdXRoQ3RybC51c2VyID0ge1xuXHRcdGVtYWlsOiAnJyxcblx0XHRwYXNzd29yZDogJydcblx0fTtcblxuXHQvLyBsb2dpblxuXHRhdXRoQ3RybC5sb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNhbGxzIHRoZSBhdXRoIHNlcnZpY2UgYW5kIHVzZXMgdGhlIGZpcmViYXNlIGZ1bmN0aW9uIFxuXHRcdC8vIGF1dGhXaXRoUGFzc3dvcmQgYnkgcGFzc2luZyBpbiB0aGUgdXNlclxuXHRcdC8vIHRoZW4gaXQgcmVkaXJlY3RzIHRvIHRoZSBob21lIHN0YXRlIGlmIGF1dGhlbnRpY2F0aW9uIHdhcyBzdWNjZXNzZnVsXG5cdFx0QXV0aC4kYXV0aFdpdGhQYXNzd29yZChhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uKGF1dGgpIHtcblx0XHRcdCRzdGF0ZS5nbygnaG9tZScpO1xuXHRcdH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuXHRcdH0pO1xuXHR9O1xuXG5cdC8vIHJlZ2lzdGVyXG5cdGF1dGhDdHJsLnJlZ2lzdGVyID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY2FsbHMgdGhlIGF1dGggc2VydmljZSBhbmQgdXNlcyB0aGUgZmlyZWJhc2UgZnVuY3Rpb25cblx0XHQvLyBjcmVhdGVVc2VyIGJ5IHBhc3NpbmcgaW4gdGVoIHVzZXJcblx0XHQvLyB0aGVuIGl0IGxvZ2luIGluIHRoZSB1c2VyIGJ5IGNhbGxpbmcgdGhlIGxvZ2luIGZ1bmN0aW9uIGluIFxuXHRcdC8vIHRoaXMgY29udHJvbGxlclxuXHRcdEF1dGguJGNyZWF0ZVVzZXIoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbih1c2VyKSB7XG5cdFx0XHRhdXRoQ3RybC5sb2dpbigpO1xuXHRcdH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuXHRcdH0pO1xuXHR9O1xuXG5cdGF1dGhDdHJsLmxvZ091dCA9IGZ1bmN0aW9uKCkge1xuXHRcdEF1dGguJHVuYXV0aCgpO1xuXHRcdCRzdGF0ZS5nbygnaG9tZScpO1xuXHR9XG5cblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgYXV0aCwgTG9ncywgZGFzaGJvYXJkKSB7XG5cdHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuXHRkYXNoYm9hcmRDdHJsLmRhc2hib2FyZCA9IGRhc2hib2FyZDtcblxuXG5cdGRhc2hib2FyZEN0cmwudGVzdERDdHJsID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29uc29sZS5sb2coJ0Zyb20gTG9ncyBTZXJ2aWNlOiAnLCBMb2dzLmdldFdlaWdodChhdXRoLnVpZCkudmFsKCkud2VpZ2h0KTtcblx0fVxuXHRkYXNoYm9hcmRDdHJsLmFkZExvZyA9IGZ1bmN0aW9uKCkge1xuXHRcdGRhc2hib2FyZEN0cmwuZGFzaGJvYXJkLiRzYXZlKCk7XG5cdH07XG5cblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uY29udHJvbGxlcignUHJvZmlsZUN0cmwnLCBmdW5jdGlvbigkc3RhdGUsIG1kNSwgYXV0aCwgcHJvZmlsZSl7XG4gICAgdmFyIHByb2ZpbGVDdHJsID0gdGhpcztcblxuXHRwcm9maWxlQ3RybC5wcm9maWxlID0gcHJvZmlsZTtcblxuXHRwcm9maWxlQ3RybC51cGRhdGVQcm9maWxlID0gZnVuY3Rpb24oKXtcblx0ICBwcm9maWxlQ3RybC5wcm9maWxlLmVtYWlsSGFzaCA9IG1kNS5jcmVhdGVIYXNoKGF1dGgucGFzc3dvcmQuZW1haWwpO1xuXHQgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKTtcblx0fTtcblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnQXV0aCcsIGZ1bmN0aW9uKCRmaXJlYmFzZUF1dGgsIEZpcmViYXNlVXJsKSB7XG5cdHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuXHR2YXIgYXV0aCA9ICRmaXJlYmFzZUF1dGgocmVmKTtcblxuXHRyZXR1cm4gYXV0aDtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmZhY3RvcnkoJ0xvZ3MnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCkge1xuXHR2YXIgbG9nc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbG9ncycpO1xuXHR2YXIgbG9ncyA9ICRmaXJlYmFzZUFycmF5KGxvZ3NSZWYpO1xuXG5cblx0dmFyIExvZ3MgPSB7XG5cdFx0Z2V0TG9nczogZnVuY3Rpb24odWlkKSB7XG5cdFx0XHRyZXR1cm4gJGZpcmViYXNlT2JqZWN0KGxvZ3NSZWYuY2hpbGQodWlkKSk7XG5cdFx0fSxcblx0XHRnZXRXZWlnaHQ6IGZ1bmN0aW9uKHVpZCkge1xuXHRcdFx0dmFyIGRhdGE7XG5cdFx0XHRsb2dzUmVmLmNoaWxkKHVpZCkub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKGRhdGFTbmFwc2hvdCkge1xuXHRcdFx0XHRkYXRhID0gZGF0YVNuYXBzaG90O1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9LFxuXHRcdGFsbDogbG9nc1xuXHR9O1xuXG5cdHJldHVybiBMb2dzO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnVXNlcnMnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCl7XG4gIHZhciB1c2Vyc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMnKTtcbiAgdmFyIHVzZXJzID0gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYpO1xuXG5cdHZhciBVc2VycyA9IHtcblx0XHRnZXRQcm9maWxlOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcblx0ICB9LFxuXHRcdGdldERpc3BsYXlOYW1lOiBmdW5jdGlvbih1aWQpe1xuXHQgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5kaXNwbGF5TmFtZTtcblx0ICB9LFxuXHRcdGdldEdyYXZhdGFyOiBmdW5jdGlvbih1aWQpe1xuICBcdFx0cmV0dXJuICcvL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyLycgKyB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZW1haWxIYXNoO1xuXHRcdH0sXG5cdFx0YWxsOiB1c2Vyc1xuXHR9O1xuXG5cdHJldHVybiBVc2Vycztcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
