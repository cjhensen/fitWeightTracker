angular.module("ag-app",["firebase","ui.router","templatesCache","angular-md5"]).config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("home",{url:"/",templateUrl:"home.html"}).state("login",{url:"/login",controller:"AuthCtrl as authCtrl",templateUrl:"login.html",resolve:{requireNoAuth:["$state","Auth",function(e,r){return r.$requireAuth().then(function(r){e.go("dashboard")},function(e){})}]}}).state("register",{url:"/register",controller:"AuthCtrl as authCtrl",templateUrl:"register.html",resolve:{requireNoAuth:["$state","Auth",function(e,r){return r.$requireAuth().then(function(r){e.go("home")},function(e){})}]}}).state("dashboard",{url:"/dashboard",controller:"DashboardCtrl as dashboardCtrl",templateUrl:"dashboard.html",resolve:{auth:["$state","Users","Auth",function(e,r,t){return t.$requireAuth()["catch"](function(){e.go("home")})}],dashboard:["Logs","Auth",function(e,r){return r.$requireAuth().then(function(r){return e.getLogs(r.uid).$loaded()})}]}}).state("profile",{url:"/profile",controller:"ProfileCtrl as profileCtrl",templateUrl:"profile.html",resolve:{auth:["$state","Users","Auth",function(e,r,t){return t.$requireAuth()["catch"](function(){e.go("home")})}],profile:["Users","Auth",function(e,r){return r.$requireAuth().then(function(r){return e.getProfile(r.uid).$loaded()})}]}}),r.otherwise("/")}]).constant("FirebaseUrl","https://ag-app.firebaseio.com/"),angular.module("ag-app").controller("AuthCtrl",["Auth","$state",function(e,r){var t=this;t.user={email:"",password:""},t.login=function(){e.$authWithPassword(t.user).then(function(e){r.go("home")},function(e){t.error=e})},t.register=function(){e.$createUser(t.user).then(function(e){t.login()},function(e){t.error=e})},t.logOut=function(){e.$unauth(),r.go("home")}}]),angular.module("ag-app").controller("DashboardCtrl",["$state","auth","Logs","dashboard",function(e,r,t,a){var o=this;o.dashboard=a,o.testDCtrl=function(){console.log("From Logs Service: ",t.getWeight(r.uid).val().weight)},o.addLog=function(){o.dashboard.$save()}}]),angular.module("ag-app").controller("ProfileCtrl",["$state","md5","auth","profile",function(e,r,t,a){var o=this;o.profile=a,o.updateProfile=function(){o.profile.emailHash=r.createHash(t.password.email),o.profile.$save()}}]),angular.module("ag-app").factory("Auth",["$firebaseAuth","FirebaseUrl",function(e,r){var t=new Firebase(r),a=e(t);return a}]),angular.module("ag-app").factory("Logs",["$firebaseArray","$firebaseObject","FirebaseUrl",function(e,r,t){var a=new Firebase(t+"logs"),o=e(a),n={getLogs:function(e){return r(a.child(e))},getWeight:function(e){var r;return a.child(e).once("value",function(e){r=e}),r},all:o};return n}]),angular.module("ag-app").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl",function(e,r,t){var a=new Firebase(t+"users"),o=e(a),n={getProfile:function(e){return r(a.child(e))},getDisplayName:function(e){return o.$getRecord(e).displayName},getGravatar:function(e){return"//www.gravatar.com/avatar/"+o.$getRecord(e).emailHash},all:o};return n}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2F1dGguY3RybC5qcyIsImNvbnRyb2xsZXJzL2Rhc2hib2FyZC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZS5jdHJsLmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvbG9ncy5zZXJ2aWNlLmpzIiwic2VydmljZXMvdXNlcnMuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsIiRyZXF1aXJlQXV0aCIsInRoZW4iLCJhdXRoIiwiZ28iLCJlcnJvciIsIlVzZXJzIiwiZGFzaGJvYXJkIiwiTG9ncyIsImdldExvZ3MiLCJ1aWQiLCIkbG9hZGVkIiwicHJvZmlsZSIsImdldFByb2ZpbGUiLCJvdGhlcndpc2UiLCJjb25zdGFudCIsImF1dGhDdHJsIiwidGhpcyIsInVzZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwibG9naW4iLCIkYXV0aFdpdGhQYXNzd29yZCIsInJlZ2lzdGVyIiwiJGNyZWF0ZVVzZXIiLCJsb2dPdXQiLCIkdW5hdXRoIiwiZGFzaGJvYXJkQ3RybCIsInRlc3REQ3RybCIsImNvbnNvbGUiLCJsb2ciLCJnZXRXZWlnaHQiLCJ2YWwiLCJ3ZWlnaHQiLCJhZGRMb2ciLCIkc2F2ZSIsIm1kNSIsInByb2ZpbGVDdHJsIiwidXBkYXRlUHJvZmlsZSIsImVtYWlsSGFzaCIsImNyZWF0ZUhhc2giLCJmYWN0b3J5IiwiJGZpcmViYXNlQXV0aCIsIkZpcmViYXNlVXJsIiwicmVmIiwiRmlyZWJhc2UiLCIkZmlyZWJhc2VBcnJheSIsIiRmaXJlYmFzZU9iamVjdCIsImxvZ3NSZWYiLCJsb2dzIiwiY2hpbGQiLCJkYXRhIiwib25jZSIsImRhdGFTbmFwc2hvdCIsImFsbCIsInVzZXJzUmVmIiwidXNlcnMiLCJnZXREaXNwbGF5TmFtZSIsIiRnZXRSZWNvcmQiLCJkaXNwbGF5TmFtZSIsImdldEdyYXZhdGFyIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxVQUNBLFdBQ0EsWUFDQSxpQkFDQSxnQkFFQUMsUUFBQSxpQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUNBRSxNQUFBLFFBQ0FDLElBQUEsSUFDQUMsWUFBQSxjQUVBRixNQUFBLFNBQ0FDLElBQUEsU0FDQUUsV0FBQSx1QkFDQUQsWUFBQSxhQUNBRSxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxjQUNBLFNBQUFDLFdBTUFaLE1BQUEsWUFDQUMsSUFBQSxZQUNBRSxXQUFBLHVCQUNBRCxZQUFBLGdCQUNBRSxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxTQUNBLFNBQUFDLFdBTUFaLE1BQUEsYUFDQUMsSUFBQSxhQUNBRSxXQUFBLGlDQUNBRCxZQUFBLGlCQUNBRSxTQUNBTSxNQUFBLFNBQUEsUUFBQSxPQUFBLFNBQUFKLEVBQUFPLEVBQUFOLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUQsU0FBQSxXQUNBRCxFQUFBSyxHQUFBLFlBR0FHLFdBQUEsT0FBQSxPQUFBLFNBQUFDLEVBQUFSLEdBQ0EsTUFBQUEsR0FBQUMsZUFBQUMsS0FBQSxTQUFBQyxHQUNBLE1BQUFLLEdBQUFDLFFBQUFOLEVBQUFPLEtBQUFDLGlCQUtBbEIsTUFBQSxXQUNBQyxJQUFBLFdBQ0FFLFdBQUEsNkJBQ0FELFlBQUEsZUFDQUUsU0FDQU0sTUFBQSxTQUFBLFFBQUEsT0FBQSxTQUFBSixFQUFBTyxFQUFBTixHQUNBLE1BQUFBLEdBQUFDLGVBQUFELFNBQUEsV0FDQUQsRUFBQUssR0FBQSxZQUdBUSxTQUFBLFFBQUEsT0FBQSxTQUFBTixFQUFBTixHQUNBLE1BQUFBLEdBQUFDLGVBQUFDLEtBQUEsU0FBQUMsR0FDQSxNQUFBRyxHQUFBTyxXQUFBVixFQUFBTyxLQUFBQyxpQkFLQW5CLEVBQUFzQixVQUFBLFFBRUFDLFNBQUEsY0FBQSxrQ0M3RUEzQixRQUFBQyxPQUFBLFVBQ0FPLFdBQUEsWUFBQSxPQUFBLFNBQUEsU0FBQUksRUFBQUQsR0FDQSxHQUFBaUIsR0FBQUMsSUFFQUQsR0FBQUUsTUFDQUMsTUFBQSxHQUNBQyxTQUFBLElBSUFKLEVBQUFLLE1BQUEsV0FJQXJCLEVBQUFzQixrQkFBQU4sRUFBQUUsTUFBQWhCLEtBQUEsU0FBQUMsR0FDQUosRUFBQUssR0FBQSxTQUNBLFNBQUFDLEdBQ0FXLEVBQUFYLE1BQUFBLEtBS0FXLEVBQUFPLFNBQUEsV0FLQXZCLEVBQUF3QixZQUFBUixFQUFBRSxNQUFBaEIsS0FBQSxTQUFBZ0IsR0FDQUYsRUFBQUssU0FDQSxTQUFBaEIsR0FDQVcsRUFBQVgsTUFBQUEsS0FJQVcsRUFBQVMsT0FBQSxXQUNBekIsRUFBQTBCLFVBQ0EzQixFQUFBSyxHQUFBLFlDcENBaEIsUUFBQUMsT0FBQSxVQUNBTyxXQUFBLGlCQUFBLFNBQUEsT0FBQSxPQUFBLFlBQUEsU0FBQUcsRUFBQUksRUFBQUssRUFBQUQsR0FDQSxHQUFBb0IsR0FBQVYsSUFFQVUsR0FBQXBCLFVBQUFBLEVBR0FvQixFQUFBQyxVQUFBLFdBQ0FDLFFBQUFDLElBQUEsc0JBQUF0QixFQUFBdUIsVUFBQTVCLEVBQUFPLEtBQUFzQixNQUFBQyxTQUVBTixFQUFBTyxPQUFBLFdBQ0FQLEVBQUFwQixVQUFBNEIsWUNYQS9DLFFBQUFDLE9BQUEsVUFDQU8sV0FBQSxlQUFBLFNBQUEsTUFBQSxPQUFBLFVBQUEsU0FBQUcsRUFBQXFDLEVBQUFqQyxFQUFBUyxHQUNBLEdBQUF5QixHQUFBcEIsSUFFQW9CLEdBQUF6QixRQUFBQSxFQUVBeUIsRUFBQUMsY0FBQSxXQUNBRCxFQUFBekIsUUFBQTJCLFVBQUFILEVBQUFJLFdBQUFyQyxFQUFBaUIsU0FBQUQsT0FDQWtCLEVBQUF6QixRQUFBdUIsWUNSQS9DLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsUUFBQSxnQkFBQSxjQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQSxHQUFBQyxVQUFBRixHQUNBeEMsRUFBQXVDLEVBQUFFLEVBRUEsT0FBQXpDLE1DTEFmLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsUUFBQSxpQkFBQSxrQkFBQSxjQUFBLFNBQUFLLEVBQUFDLEVBQUFKLEdBQ0EsR0FBQUssR0FBQSxHQUFBSCxVQUFBRixFQUFBLFFBQ0FNLEVBQUFILEVBQUFFLEdBR0F4QyxHQUNBQyxRQUFBLFNBQUFDLEdBQ0EsTUFBQXFDLEdBQUFDLEVBQUFFLE1BQUF4QyxLQUVBcUIsVUFBQSxTQUFBckIsR0FDQSxHQUFBeUMsRUFJQSxPQUhBSCxHQUFBRSxNQUFBeEMsR0FBQTBDLEtBQUEsUUFBQSxTQUFBQyxHQUNBRixFQUFBRSxJQUVBRixHQUVBRyxJQUFBTCxFQUdBLE9BQUF6QyxNQ3BCQXBCLFFBQUFDLE9BQUEsVUFDQW9ELFFBQUEsU0FBQSxpQkFBQSxrQkFBQSxjQUFBLFNBQUFLLEVBQUFDLEVBQUFKLEdBQ0EsR0FBQVksR0FBQSxHQUFBVixVQUFBRixFQUFBLFNBQ0FhLEVBQUFWLEVBQUFTLEdBRUFqRCxHQUNBTyxXQUFBLFNBQUFILEdBQ0EsTUFBQXFDLEdBQUFRLEVBQUFMLE1BQUF4QyxLQUVBK0MsZUFBQSxTQUFBL0MsR0FDQSxNQUFBOEMsR0FBQUUsV0FBQWhELEdBQUFpRCxhQUVBQyxZQUFBLFNBQUFsRCxHQUNBLE1BQUEsNkJBQUE4QyxFQUFBRSxXQUFBaEQsR0FBQTZCLFdBRUFlLElBQUFFLEVBR0EsT0FBQWxEIiwiZmlsZSI6ImFwcC5idW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29uZmlndXJlIHRoZSByb3V0ZXMgZm9yIHRoZSBhcHBcbmFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnLCBbXG5cdCdmaXJlYmFzZScsIFxuXHQndWkucm91dGVyJywgXG5cdCd0ZW1wbGF0ZXNDYWNoZScsIFxuXHQnYW5ndWxhci1tZDUnXG5cdF0pXG4uY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXJcblx0XHQuc3RhdGUoJ2hvbWUnLCB7XG5cdFx0XHR1cmw6ICcvJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnaG9tZS5odG1sJ1xuXHRcdH0pXG5cdFx0LnN0YXRlKCdsb2dpbicsIHtcblx0XHRcdHVybDogJy9sb2dpbicsXG5cdFx0XHRjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyxcblx0XHRcdHJlc29sdmU6IHtcblx0XHRcdCAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24oJHN0YXRlLCBBdXRoKXtcblx0XHRcdCAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdFx0ICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcblx0XHRcdCAgICB9LCBmdW5jdGlvbihlcnJvcil7XG5cdFx0XHQgICAgICByZXR1cm47XG5cdFx0XHQgICAgfSk7XG5cdFx0XHQgIH1cblx0XHRcdH1cblx0XHR9KVxuXHRcdC5zdGF0ZSgncmVnaXN0ZXInLCB7XG5cdFx0XHR1cmw6ICcvcmVnaXN0ZXInLFxuXHRcdFx0Y29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0XHQgIHJlcXVpcmVOb0F1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgQXV0aCl7XG5cdFx0XHQgICAgcmV0dXJuIEF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbihhdXRoKXtcblx0XHRcdCAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuXHRcdFx0ICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdCAgICAgIHJldHVybjtcblx0XHRcdCAgICB9KTtcblx0XHRcdCAgfVxuXHRcdFx0fVxuXHRcdH0pXG5cdFx0LnN0YXRlKCdkYXNoYm9hcmQnLCB7XG5cdFx0XHR1cmw6ICcvZGFzaGJvYXJkJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdkYXNoYm9hcmQuaHRtbCcsXG5cdFx0XHRyZXNvbHZlOiB7XG5cdFx0ICAgIGF1dGg6IGZ1bmN0aW9uKCRzdGF0ZSwgVXNlcnMsIEF1dGgpe1xuXHRcdCAgICAgIHJldHVybiBBdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uKCl7XG5cdFx0ICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfSxcblx0XHQgICAgZGFzaGJvYXJkOiBmdW5jdGlvbihMb2dzLCBBdXRoKXtcblx0XHQgICAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdCAgICAgICAgcmV0dXJuIExvZ3MuZ2V0TG9ncyhhdXRoLnVpZCkuJGxvYWRlZCgpO1xuXHRcdCAgICAgIH0pO1xuXHRcdCAgICB9XG5cdFx0ICB9XG5cdFx0fSlcblx0XHQuc3RhdGUoJ3Byb2ZpbGUnLCB7XG5cdFx0XHR1cmw6ICcvcHJvZmlsZScsXG5cdFx0XHRjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICdwcm9maWxlLmh0bWwnLFxuXHRcdFx0cmVzb2x2ZToge1xuXHRcdCAgICBhdXRoOiBmdW5jdGlvbigkc3RhdGUsIFVzZXJzLCBBdXRoKXtcblx0XHQgICAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbigpe1xuXHRcdCAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG5cdFx0ICAgICAgfSk7XG5cdFx0ICAgIH0sXG5cdFx0ICAgIHByb2ZpbGU6IGZ1bmN0aW9uKFVzZXJzLCBBdXRoKXtcblx0XHQgICAgICByZXR1cm4gQXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uKGF1dGgpe1xuXHRcdCAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKTtcblx0XHQgICAgICB9KTtcblx0XHQgICAgfVxuXHRcdCAgfVxuXHRcdH0pO1xuXHRcdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pXG4uY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vYWctYXBwLmZpcmViYXNlaW8uY29tLycpOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmNvbnRyb2xsZXIoJ0F1dGhDdHJsJywgZnVuY3Rpb24oQXV0aCwgJHN0YXRlKSB7XG5cdHZhciBhdXRoQ3RybCA9IHRoaXM7XG5cblx0YXV0aEN0cmwudXNlciA9IHtcblx0XHRlbWFpbDogJycsXG5cdFx0cGFzc3dvcmQ6ICcnXG5cdH07XG5cblx0Ly8gbG9naW5cblx0YXV0aEN0cmwubG9naW4gPSBmdW5jdGlvbigpIHtcblx0XHQvLyBjYWxscyB0aGUgYXV0aCBzZXJ2aWNlIGFuZCB1c2VzIHRoZSBmaXJlYmFzZSBmdW5jdGlvbiBcblx0XHQvLyBhdXRoV2l0aFBhc3N3b3JkIGJ5IHBhc3NpbmcgaW4gdGhlIHVzZXJcblx0XHQvLyB0aGVuIGl0IHJlZGlyZWN0cyB0byB0aGUgaG9tZSBzdGF0ZSBpZiBhdXRoZW50aWNhdGlvbiB3YXMgc3VjY2Vzc2Z1bFxuXHRcdEF1dGguJGF1dGhXaXRoUGFzc3dvcmQoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbihhdXRoKSB7XG5cdFx0XHQkc3RhdGUuZ28oJ2hvbWUnKTtcblx0XHR9LCBmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0YXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcblx0XHR9KTtcblx0fTtcblxuXHQvLyByZWdpc3RlclxuXHRhdXRoQ3RybC5yZWdpc3RlciA9IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNhbGxzIHRoZSBhdXRoIHNlcnZpY2UgYW5kIHVzZXMgdGhlIGZpcmViYXNlIGZ1bmN0aW9uXG5cdFx0Ly8gY3JlYXRlVXNlciBieSBwYXNzaW5nIGluIHRlaCB1c2VyXG5cdFx0Ly8gdGhlbiBpdCBsb2dpbiBpbiB0aGUgdXNlciBieSBjYWxsaW5nIHRoZSBsb2dpbiBmdW5jdGlvbiBpbiBcblx0XHQvLyB0aGlzIGNvbnRyb2xsZXJcblx0XHRBdXRoLiRjcmVhdGVVc2VyKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24odXNlcikge1xuXHRcdFx0YXV0aEN0cmwubG9naW4oKTtcblx0XHR9LCBmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0YXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcblx0XHR9KTtcblx0fTtcblxuXHRhdXRoQ3RybC5sb2dPdXQgPSBmdW5jdGlvbigpIHtcblx0XHRBdXRoLiR1bmF1dGgoKTtcblx0XHQkc3RhdGUuZ28oJ2hvbWUnKTtcblx0fVxuXG5cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhZy1hcHAnKVxuLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZEN0cmwnLCBmdW5jdGlvbigkc3RhdGUsIGF1dGgsIExvZ3MsIGRhc2hib2FyZCkge1xuXHR2YXIgZGFzaGJvYXJkQ3RybCA9IHRoaXM7XG5cblx0ZGFzaGJvYXJkQ3RybC5kYXNoYm9hcmQgPSBkYXNoYm9hcmQ7XG5cblxuXHRkYXNoYm9hcmRDdHJsLnRlc3REQ3RybCA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKCdGcm9tIExvZ3MgU2VydmljZTogJywgTG9ncy5nZXRXZWlnaHQoYXV0aC51aWQpLnZhbCgpLndlaWdodCk7XG5cdH1cblx0ZGFzaGJvYXJkQ3RybC5hZGRMb2cgPSBmdW5jdGlvbigpIHtcblx0XHRkYXNoYm9hcmRDdHJsLmRhc2hib2FyZC4kc2F2ZSgpO1xuXHR9O1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgbWQ1LCBhdXRoLCBwcm9maWxlKXtcbiAgICB2YXIgcHJvZmlsZUN0cmwgPSB0aGlzO1xuXG5cdHByb2ZpbGVDdHJsLnByb2ZpbGUgPSBwcm9maWxlO1xuXG5cdHByb2ZpbGVDdHJsLnVwZGF0ZVByb2ZpbGUgPSBmdW5jdGlvbigpe1xuXHQgIHByb2ZpbGVDdHJsLnByb2ZpbGUuZW1haWxIYXNoID0gbWQ1LmNyZWF0ZUhhc2goYXV0aC5wYXNzd29yZC5lbWFpbCk7XG5cdCAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpO1xuXHR9O1xuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5mYWN0b3J5KCdBdXRoJywgZnVuY3Rpb24oJGZpcmViYXNlQXV0aCwgRmlyZWJhc2VVcmwpIHtcblx0dmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG5cdHZhciBhdXRoID0gJGZpcmViYXNlQXV0aChyZWYpO1xuXG5cdHJldHVybiBhdXRoO1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FnLWFwcCcpXG4uZmFjdG9yeSgnTG9ncycsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsKSB7XG5cdHZhciBsb2dzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydsb2dzJyk7XG5cdHZhciBsb2dzID0gJGZpcmViYXNlQXJyYXkobG9nc1JlZik7XG5cblxuXHR2YXIgTG9ncyA9IHtcblx0XHRnZXRMb2dzOiBmdW5jdGlvbih1aWQpIHtcblx0XHRcdHJldHVybiAkZmlyZWJhc2VPYmplY3QobG9nc1JlZi5jaGlsZCh1aWQpKTtcblx0XHR9LFxuXHRcdGdldFdlaWdodDogZnVuY3Rpb24odWlkKSB7XG5cdFx0XHR2YXIgZGF0YTtcblx0XHRcdGxvZ3NSZWYuY2hpbGQodWlkKS5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oZGF0YVNuYXBzaG90KSB7XG5cdFx0XHRcdGRhdGEgPSBkYXRhU25hcHNob3Q7XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0sXG5cdFx0YWxsOiBsb2dzXG5cdH07XG5cblx0cmV0dXJuIExvZ3M7XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYWctYXBwJylcbi5mYWN0b3J5KCdVc2VycycsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsKXtcbiAgdmFyIHVzZXJzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd1c2VycycpO1xuICB2YXIgdXNlcnMgPSAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZik7XG5cblx0dmFyIFVzZXJzID0ge1xuXHRcdGdldFByb2ZpbGU6IGZ1bmN0aW9uKHVpZCl7XG5cdCAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpO1xuXHQgIH0sXG5cdFx0Z2V0RGlzcGxheU5hbWU6IGZ1bmN0aW9uKHVpZCl7XG5cdCAgICByZXR1cm4gdXNlcnMuJGdldFJlY29yZCh1aWQpLmRpc3BsYXlOYW1lO1xuXHQgIH0sXG5cdFx0Z2V0R3JhdmF0YXI6IGZ1bmN0aW9uKHVpZCl7XG4gIFx0XHRyZXR1cm4gJy8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvJyArIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5lbWFpbEhhc2g7XG5cdFx0fSxcblx0XHRhbGw6IHVzZXJzXG5cdH07XG5cblx0cmV0dXJuIFVzZXJzO1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
